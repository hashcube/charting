<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js" type="text/javascript"></script>
<script src="js/underscore.js" type="text/javascript"></script>
<script src="js/highcharts.src.js" type="text/javascript"></script>

<script type='text/javascript'>
Array.prototype.min = function() {
  var min = this[0];
  for(var i=0; i < this.length; i++){
    if(this[i] < min)
      min = this[i];
  }
  return min;
}

Array.prototype.max = function() {
  var max = this[0];
  for(var i=0; i < this.length; i++){
    if(this[i] > max)
      max = this[i];
  }
  return max;
}
</script>

<script type="text/javascript">
var data = <?php echo $json_data; ?>;
$(document).ready(function() {

  var chartid = 0;
  _.each(data, function(chart) {
    chartel_id = createDiv(chartid);
    createChart(chartel_id, chart);
    chartid++;
  });
});

function createDiv(chartid) {
  var chartel_id = 'chart_'+chartid;
  var el = $("<div></div>");
  el.attr('id',chartel_id);
  el.css('margin', '20px');
  $('body').append(el);
  return chartel_id;
}

function createChart(el, data) {
  var chart0_info = data.charts[0];
  var series_data = Array();
  _.each(data.charts, function(d) {
    var obj = {name: d.y_axis,
               data: _.values(d.result.y)}
    series_data.push(obj);
  });

  var chartid = new Highcharts.Chart ({
    chart: {
      renderTo: el,
      type: data.chart_type
    },
    title: {
      text: data.title
    },
    xAxis: {
      title: {
        text: data.x_axis
      },
      categories: _.values(chart0_info.result.x),
      labels: {
        rotation: -45,
        align: "right"
      }
    },
    yAxis: {
      min : 0,
      title: {
        text: data.y_axis
      }
    },
    series: series_data
  });
  return chartid;
}
</script>
<h1>Sudoku Quest</h1>
